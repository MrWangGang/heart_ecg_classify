# 12导联心电图(ECG)分类项目

## 项目概述
本项目聚焦于12导联心电图（ECG）数据的自动分类任务，基于一维卷积神经网络（Conv1D）构建核心模型，旨在通过深度学习技术实现对心脏相关状态或疾病的高效识别。12导联ECG作为临床常用的心脏功能评估手段，包含丰富的心脏电活动信息，本项目通过模型对这些时序信号进行特征挖掘与分类，为临床心电诊断、心脏疾病筛查等场景提供自动化技术支持。
```
┌─────────────────────────────────────────────────────────────┐
│ 输入: (batch_size, num_channels, input_length)              │
│ 注: num_channels为ECG导联数，input_length为时间序列长度      │
└───────────────────────────────┬─────────────────────────────┘
                                │
┌───────────────────────────────▼─────────────────────────────┐
│ 卷积层序列 (conv_layers)                                    │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ 第一层卷积                                             │ │
│ │ Conv1d(num_channels → 64, kernel=7, padding=3)         │ │
│ │ ReLU激活函数                                           │ │
│ │ MaxPool1d(kernel=3, stride=2) → 下采样                 │ │
│ └───────────────────────┬─────────────────────────────────┘ │
│                         │                                   │
│ ┌───────────────────────▼─────────────────────────────────┐ │
│ │ 第二层卷积                                             │ │
│ │ Conv1d(64 → 128, kernel=5, padding=2)                  │ │
│ │ ReLU激活函数                                           │ │
│ │ MaxPool1d(kernel=3, stride=2) → 下采样                 │ │
│ └───────────────────────┬─────────────────────────────────┘ │
│                         │                                   │
│ ┌───────────────────────▼─────────────────────────────────┐ │
│ │ 第三层卷积                                             │ │
│ │ Conv1d(128 → 256, kernel=3, padding=1)                 │ │
│ │ ReLU激活函数                                           │ │
│ │ MaxPool1d(kernel=3, stride=2) → 下采样                 │ │
│ └───────────────────────┬─────────────────────────────────┘ │
└─────────────────────────┬───────────────────────────────────┘
                          │
┌─────────────────────────▼───────────────────────────────────┐
│ 自适应平均池化 (avgpool)                                    │
│ AdaptiveAvgPool1d(1) → (batch_size, 256, 1)                 │
└─────────────────────────┬───────────────────────────────────┘
                          │
┌─────────────────────────▼───────────────────────────────────┐
│ 展平操作 (flatten)                                          │
│ torch.flatten(x, 1) → (batch_size, 256)                     │
└─────────────────────────┬───────────────────────────────────┘
                          │
┌─────────────────────────▼───────────────────────────────────┐
│ 全连接层序列 (fc_layers)                                    │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ Linear(256 → 128)                                      │ │
│ │ ReLU激活函数                                           │ │
│ │ Dropout(0.5) → 防止过拟合                              │ │
│ └───────────────────────┬─────────────────────────────────┘ │
│                         │                                   │
│ ┌───────────────────────▼─────────────────────────────────┐ │
│ │ Linear(128 → num_classes) → 输出分类结果                │ │
│ └─────────────────────────────────────────────────────────┘ │
└─────────────────────────┬───────────────────────────────────┘
                          │
┌─────────────────────────▼───────────────────────────────────┐
│ 输出: (batch_size, num_classes)                             │
│ 注: 输出为各类别的预测分数                                  │
└─────────────────────────────────────────────────────────────┘
```
## 核心功能与价值
- **12导联数据适配**：模型专门针对12导联ECG的多通道特性设计，能有效捕捉不同导联间的关联信息，充分利用临床标准ECG数据的完整特征；
- **时序特征精准提取**：采用一维卷积操作适配ECG时间序列信号的特点，可精准捕获心电图中的关键波形（如P波、QRS波、T波）、间期长度、心率变异等与心脏状态相关的特征；
- **临床辅助价值**：可应用于心律失常（如房颤、室性早搏）、心肌缺血、心肌梗死等常见心脏疾病的自动识别，帮助降低人工诊断的工作量，提升诊断效率与一致性；
- **泛化能力保障**：模型融入Dropout正则化与自适应池化设计，既能减轻过拟合风险，又能兼容不同长度的ECG输入数据，适配多样化的临床数据场景。

## 应用场景
- 医院临床心电诊断辅助：为医生提供ECG分类参考，减少漏诊、误诊风险；
- 社区医疗与体检筛查：快速完成大规模人群的心脏健康初筛；
- 远程心电监测：结合可穿戴设备采集的12导联数据，实现实时心脏状态评估；
- 医学教学与科研：为心电相关的教学演示、疾病特征研究提供数据与模型支持。

## 环境要求
- Python 3.x
- PyTorch（深度学习框架）
- NumPy（数据预处理）
- （可选）Matplotlib/PyPlot（ECG波形与实验结果可视化）

## 使用流程
1. **数据准备**：将12导联ECG数据按`(样本数, 12, 时间步长)`格式整理（12为导联数，时间步长为ECG信号的采样点数量）；
2. **模型初始化**：根据具体分类任务（如“正常/房颤/室早”三分类），设置`num_classes`参数，初始化模型：`model = ECGClassifier(num_channels=12, num_classes=目标类别数)`；
3. **训练与评估**：使用标注好的ECG数据集进行模型训练，通过准确率、F1分数、AUC-ROC等指标评估模型性能；
4. **推理应用**：加载训练完成的模型，对新的12导联ECG数据进行分类预测，输出心脏状态或疾病类型结果。

## 性能特点
- 对12导联ECG的多通道时序特征适配性强，分类精度优于单导联或少量导联的模型；
- 模型结构轻量化，训练与推理效率高，可部署于普通计算设备或低资源环境；
- 针对临床ECG数据的噪声特性，模型具备一定抗干扰能力，在含轻微噪声的数据集上仍能保持稳定性能。